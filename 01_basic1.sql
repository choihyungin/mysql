CREATE DATABASE MYDB;

-- CREATE TABLE TABLE_NAME
-- CREATE COLUMNS(NAME, CHAR(LEN))
CREATE TABLE 연습 (
	이메일 VARCHAR(20),
    비밀번호 VARCHAR(20),
    나이 INT
);

CREATE TABLE 연습1 (
	이메일 VARCHAR(20),
    비밀번호 VARCHAR(20),
    나이 INT,
    PRIMARY KEY (이메일)
);

-- PRIMARY KET (COL) → SET COL AS PRIMARY KEY
CREATE TABLE MEMBER2 (
	NUM INT,
    NAME VARCHAR(10),
    AGE INT,
    EMAIL VARCHAR(50),
    PHONE VARCHAR(20),
    PRIMARY KEY (NUM)
);
    
CREATE TABLE 부서 ( 
	부서번호 INT,
	부서이름 VARCHAR(10), 
	PRIMARY KEY(부서번호)
);

-- FROEIGN KEY (COL) REFERENCES TABLE(COL)
CREATE TABLE 사원 ( 
	사원번호 INT,
	사원이름 VARCHAR(10), 
	소속부서 INT,
	PRIMARY KEY(사원번호),
	FOREIGN KEY(소속부서) REFERENCES 부서(부서번호) 
);

-- ALTER TABLE TABLE_NAME
ALTER TABLE 연습
	ADD PRIMARY KEY (이메일);
    
ALTER TABLE 연습
	ADD 대상 VARCHAR(20);
    
ALTER TABLE 연습
	ADD FOREIGN KEY (대상) REFERENCES 연습1 (이메일);
    
CREATE TABLE EMP (
	EMPNO INT,
    ENAME VARCHAR(10),
    JOB VARCHAR(9),
    MGR INT,
    HIREDATE DATETIME,
    SAL INT,
    COMM INT,
    PRIMARY KEY (EMPNO)
);

CREATE TABLE DEPT (
	DEPTNO TINYINT,
    DNAME VARCHAR(4),
    LOC VARCHAR(13),
    PRIMARY KEY (DEPTNO)
);

-- CREATE COLUMN FIRST AND THEN SET FOREIGN KEY
ALTER TABLE EMP 
	ADD DEPTNO TINYINT;
    
ALTER TABLE EMP
	ADD FOREIGN KEY (DEPTNO) REFERENCES DEPT (DEPTNO);

-- DROP COLUMN
ALTER TABLE MEMBER2
	DROP AGE;
    
ALTER TABLE MEMBER2
	MODIFY EMAIL VARCHAR(100);
    
CREATE TABLE 고객 (
	고객아이디 VARCHAR(20), 
    고객이름 VARCHAR(10) NOT NULL, 
    나이 INT,
	등급 VARCHAR(10) NOT NULL, 
    직업 VARCHAR(20),
	적립금 INT DEFAULT 0,
	PRIMARY KEY(고객아이디)
);

CREATE TABLE 제품 ( 
	제품번호 CHAR(3), 
    제품명 VARCHAR(20), 
    재고량 INT,
	단가 INT,
	제조업체 VARCHAR(20), 
    PRIMARY KEY(제품번호)
);

CREATE TABLE 주문 ( 
	주문번호 CHAR(3), 
	주문고객 VARCHAR(20), 
	주문제품 CHAR(3),
	수량 INT,
	배송지 VARCHAR(30),
	주문일자 DATETIME,
	PRIMARY KEY(주문번호),
	FOREIGN KEY(주문고객) REFERENCES 고객(고객아이디), 
	FOREIGN KEY(주문제품) REFERENCES 제품(제품번호)
);

-- CHECK TABLE_CONSTRAINTS
SELECT * FROM information_schema.TABLE_CONSTRAINTS;

ALTER TABLE EMP 
	DROP FOREIGN KEY `EMP_IBFK_1`;

ALTER TABLE EMP ADD
	CONSTRAINT `FK_EMP_DEPTEMP`
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
    ON DELETE CASCADE;

-- INSERT DATA
-- INSERT INTO TABLE_NAME (COLUMN_NAME) VALUES (DATA);
INSERT INTO 부서 (부서번호, 부서이름) VALUES (1, '인사부');
INSERT INTO 부서 (부서번호, 부서이름) VALUES (2, '연구부');
INSERT INTO 부서 (부서번호, 부서이름) VALUES (3, '홍보부');

INSERT INTO 사원 (사원번호, 사원이름, 소속부서) VALUES (1001, 'AAA', 3);
INSERT INTO 사원 (사원번호, 사원이름, 소속부서) VALUES (1002, 'BBB', 2);
INSERT INTO 사원 (사원번호, 사원이름, 소속부서) VALUES (1003, 'CCC', 1);

INSERT INTO MEMBER2 VALUES (1, 'A', 'aaa@gmail.com', '000-0000-0001');
INSERT INTO MEMBER2 VALUES (2, 'B', 'bbb@gmail.com', '000-0000-0002');
INSERT INTO MEMBER2 VALUES (3, 'C', 'ccc@gmail.com', '000-0000-0003');

INSERT INTO 고객 VALUES ('apple', '정소화', 20, 'gold', '학생', 1000);
INSERT INTO 고객 VALUES ('banana', '김선우', 25, 'vip', '간호사', 2500);
INSERT INTO 고객 VALUES ('carrot', '고영석', 28, 'gold', '교사', 4500);
INSERT INTO 고객 VALUES ('orange', '김용욱', 22, 'silver', '회사원', 5000);
INSERT INTO 고객 VALUES ('melon', '성원용', 35, 'gold', '학생', 0);
INSERT INTO 고객 VALUES ('peach', '오형준', NULL, 'silver', '의사', 300);
INSERT INTO 고객 VALUES ('pear', '채광준', 31, 'silver', '회사원', 500);

INSERT INTO 제품 VALUES ('p01', '그냥만두', 5000, 4500, '대한식품'); 
INSERT INTO 제품 VALUES ('p02', '매운쫄면', 2500, 5500, '민국푸드'); 
INSERT INTO 제품 VALUES ('p03', '쿵떡파이', 3600, 2600, '한빛제과'); 
INSERT INTO 제품 VALUES ('p04', '맛난초콜렛', 1250, 2500, '한빛제과'); 
INSERT INTO 제품 VALUES ('p05', '얼큰라면', 2200, 1200, '대한식품'); 
INSERT INTO 제품 VALUES ('p06', '통통우동', 1000, 1550, '민국푸드'); 
INSERT INTO 제품 VALUES ('p07', '달콤비스켓', 1650, 1500, '한빛제과');

INSERT INTO 주문 VALUES ('o01', 'apple', 'p03', 10, '서울시 마포구', '2013-01-01'); 
INSERT INTO 주문 VALUES ('o02', 'melon', 'p01', 5, '인천시 계양구', '2013-01-10'); 
INSERT INTO 주문 VALUES ('o03', 'banana', 'p06', 45, '경기도 부천시', '2013-01-11'); 
INSERT INTO 주문 VALUES ('o04', 'carrot', 'p02', 8, '부산시 금정구', '2013-02-01'); 
INSERT INTO 주문 VALUES ('o05', 'melon', 'p06', 36, '경기도 용인시', '2013-02-20'); 
INSERT INTO 주문 VALUES ('o06', 'banana', 'p01', 19, '충청북도 보은군', '2013-03-02'); 
INSERT INTO 주문 VALUES ('o07', 'apple', 'p03', 22, '서울시 영등포구', '2013-03-15');
INSERT INTO 주문 VALUES ('o08', 'pear', 'p02', 50, '강원도 춘천시', '2013-04-10'); 
INSERT INTO 주문 VALUES ('o09', 'banana', 'p04', 15, '전라남도 목포시', '2013-04-11'); 
INSERT INTO 주문 VALUES ('o10', 'carrot', 'p03', 20, '경기도 안양시', '2013-05-22');

DESC 고객;
SELECT 고객아이디, 고객이름, 등급 FROM 고객;
SELECT * FROM 주문;

SELECT 제품명, 제조업체 FROM 제품;
SELECT DISTINCT (제조업체) FROM 제품;

DESC 제품;
SELECT 제품명, 단가 AS '가격' FROM 제품;

DESC DEPT;

ALTER TABLE DEPT
	MODIFY DNAME VARCHAR(14);


SELECT DEPTNO, DNAME, LOC FROM DEPT;
SELECT EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO FROM EMP;

SELECT * FROM EMP;
SELECT ENAME, JOB, HIREDATE, SAL, DEPTNO FROM EMP;
SELECT DISTINCT JOB, DEPTNO FROM EMP;
DESC DEPT;
SELECT DNAME AS '부서명', LOC AS '부서위치' FROM DEPT;

-- SET NAME
SELECT 제품명, 단가, 단가*0.2 AS 조정단가 FROM 제품;

DESC 제품;
SELECT 제품명, 재고량, 단가 FROM 제품 WHERE 제조업체='한빛제과';

SELECT 주문제품, 수량, 주문일자 FROM 주문 WHERE 주문고객='apple' AND 수량>=15;

SELECT SAL*1.1, SAL*12 FROM EMP;
SELECT MPNO, ENAME, SAL, COMM, COMM*0.95 FROM EMP;

SELECT ENAME, JOB FROM EMP WHERE MGR=7839;
SELECT JOB, DEPTNO FROM EMP WHERE SAL>=3000;
SELECT ENAME, JOB, SAL FROM EMP WHERE JOB!='CLERK' AND JOB!='SALESMAN';
SELECT SAL, DEPTNO FROM EMP WHERE MGR=7839 OR JOB='ANALYST';
SELECT * FROM EMP WHERE (MGR=7698 OR MGR=7839) AND DEPTNO=10;

SELECT 고객이름, 나이, 등급, 적립금 FROM 고객 WHERE 고객이름 LIKE '김%';
SELECT 고객아이디, 고객이름, 등급 FROM 고객 WHERE 고객아이디 LIKE '_____';
SELECT * FROM 고객 WHERE 직업 LIKE '___' AND 고객아이디 LIKE 'a%';

SELECT 고객이름 FROM 고객 WHERE 나이 IS NULL;

SELECT ENAME, JOB FROM EMP WHERE ENAME LIKE 'A%';
SELECT ENAME, JOB FROM EMP WHERE ENAME LIKE '%N';
SELECT ENAME, DEPTNO FROM EMP WHERE ENAME LIKE '__R_';
SELECT ENAME, SAL FROM EMP WHERE ENAME LIKE '_I%';

SELECT ENAME, JOB, SAL FROM EMP WHERE MGR IS NULL;
SELECT ENAME, HIREDATE, SAL FROM EMP WHERE COMM IS NULL;
SELECT * FROM EMP WHERE MGR IS NOT NULL AND DEPTNO=20;
SELECT * FROM EMP WHERE COMM IS NOT NULL AND HIREDATE LIKE '1981-02%';

SELECT 고객이름, 등급, 나이 FROM 고객 ORDER BY 나이 DESC;
SELECT 주문고객, 주문제품, 수량, 주문일자 FROM 주문 WHERE 수량>=10 ORDER BY 주문제품 ASC, 수량 DESC;

SELECT * FROM EMP ORDER BY ENAME DESC;
SELECT * FROM EMP ORDER BY HIREDATE ASC;
SELECT * FROM EMP ORDER BY DEPTNO DESC, ENAME ASC;
SELECT * FROM EMP ORDER BY SAL DESC;

-- LIMIT
SELECT * FROM EMP LIMIT 5, 5;

-- SELECT COLUMNS FROM TABLE WHERE CONDITION ORDER BY COL DESC/ASC LIMIT INT, INT;
SELECT * FROM EMP WHERE DEPTNO=30 ORDER BY SAL DESC LIMIT 0, 5;
SELECT * FROM EMP WHERE DEPTNO=30 ORDER BY SAL DESC LIMIT 5, 5;

SELECT EMPNO, ENAME, SAL FROM EMP WHERE DEPTNO=10;
SELECT ENAME, HIREDATE, DEPTNO FROM EMP WHERE EMPNO=7369;
SELECT * FROM EMP WHERE ENAME='ALLEN';
SELECT * FROM EMP WHERE JOB!='MANAGER';
SELECT ENAME, SAL, DEPTNO FROM EMP WHERE SAL>=800;
SELECT * FROM EMP WHERE DEPTNO >=20;
SELECT * FROM EMP WHERE ENAME >= 'K%';